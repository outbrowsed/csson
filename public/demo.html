<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>OutBrowsed | CSSON</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="Utility JSON superset" />
        <meta name="keywords" content="outbrowsed, project, csson, json, superset" />
        <meta name="author" content="@OutBrowsed" />
        <meta
            name="robots"
            content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"
        />
        <meta name="language" content="English" />
        <meta name="distribution" content="Global" />
        <meta name="rating" content="General" />
        <link
            rel="preload"
            as="image"
            href="https://framerusercontent.com/images/zL3PEjX0vftOWNT8u24lzNacUGo.png"
        />
        <link
            rel="preload"
            as="font"
            href="https://fonts.googleapis.com/css2?family=Onest:wght@100..900&display=swap"
            crossorigin
        />
        <meta
            http-equiv="Content-Security-Policy"
            content="default-src *; script-src * 'unsafe-inline' 'unsafe-eval'; style-src * 'unsafe-inline'; img-src * data:; font-src *; connect-src *; frame-src *;"
        />
        <meta name="referrer" content="strict-origin-when-cross-origin" />
        <meta
            http-equiv="Permissions-Policy"
            content="geolocation=(), microphone=(), camera=(), payment=()"
        />
        <link
            href="https://framerusercontent.com/images/EKbJ5Et5vOKk2VINxvmhpPX6Lg8.png"
            rel="icon"
            media="(prefers-color-scheme: light)"
        />
        <link
            href="https://framerusercontent.com/images/2ftPQzxkEbdaN5saVSRnmHSVODI.png"
            rel="icon"
            media="(prefers-color-scheme: dark)"
        />
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="https://framerusercontent.com/images/nHrIMisnVn3Fgn9GZhki9WpKo.png"
        />
        <meta name="msapplication-TileColor" content="#000000" />
        <meta
            name="msapplication-TileImage"
            content="https://framerusercontent.com/images/zL3PEjX0vftOWNT8u24lzNacUGo.png"
        />
        <link rel="preconnect" href="https://framerusercontent.com" crossorigin />
        <link rel="dns-prefetch" href="https://framerusercontent.com" />
        <meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)" />
        <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)" />
        <meta property="og:type" content="website" />
        <meta property="og:title" content="OutBrowsed | CSSON" />
        <meta property="og:description" content="Utility JSON superset" />
        <meta
            property="og:image"
            content="https://framerusercontent.com/images/zL3PEjX0vftOWNT8u24lzNacUGo.png"
        />
        <meta property="og:image:alt" content="OutBrowsed Logo" />
        <meta property="og:image:type" content="image/png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="630" />
        <meta property="og:url" content="https://outbrowsed.xyz" />
        <meta property="og:site_name" content="OutBrowsed" />
        <meta property="og:locale" content="en_US" />
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content="OutBrowsed | CSSON" />
        <meta name="twitter:description" content="Utility JSON superset" />
        <meta
            name="twitter:image"
            content="https://framerusercontent.com/images/zL3PEjX0vftOWNT8u24lzNacUGo.png"
        />
        <meta name="twitter:image:alt" content="OutBrowsed Logo" />
        <meta name="twitter:creator" content="@OutBrowsed" />
        <meta name="twitter:site" content="@OutBrowsed" />
        <meta name="apple-mobile-web-app-title" content="OutBrowsed | CSSON" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="default" />
        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "WebSite",
                "name": "OutBrowsed",
                "url": "https://outbrowsed.xyz",
                "description": "",
                "publisher": {
                    "@type": "Organization",
                    "name": "OutBrowsed",
                    "logo": {
                        "@type": "ImageObject",
                        "url": "https://framerusercontent.com/images/zL3PEjX0vftOWNT8u24lzNacUGo.png",
                        "width": 1200,
                        "height": 630
                    }
                },
                "image": {
                    "@type": "ImageObject",
                    "url": "https://framerusercontent.com/images/zL3PEjX0vftOWNT8u24lzNacUGo.png",
                    "width": 1200,
                    "height": 630
                },
                "inLanguage": "en-US",
                "sameAs": []
            }
        </script>
        <link
            href="https://fonts.googleapis.com/css2?family=Onest:wght@100..900&display=swap"
            rel="stylesheet"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
        />
        <style>
            * {
                scroll-behavior: smooth;
            }
            *::-webkit-scrollbar {
                width: 0;
                height: 0;
            }
            * {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            body {
                font-family:
                    "Onest",
                    system-ui,
                    -apple-system,
                    BlinkMacSystemFont,
                    sans-serif;
                background: #fff;
                color: #000;
                padding: 20px;
            }
            input,
            textarea,
            pre {
                font-family: "JetBrains Mono", "Source Code Pro", monospace;
                background: #f0f0f0;
                color: #000;
                border: none;
                border-radius: 10px;
                padding: 10px;
                width: 100%;
                box-sizing: border-box;
                overflow: auto;
                scroll-behavior: smooth;
            }
            textarea {
                height: 200px;
                resize: vertical;
            }
            button {
                background: #000;
                color: #fff;
                border: none;
                border-radius: 10px;
                padding: 8px 12px;
                margin-top: 10px;
                margin-right: 5px;
                cursor: pointer;
                font-family: inherit;
            }
            button:hover {
                background: #333;
            }
            button:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }
            h1,
            h2 {
                color: #000;
            }
            .hljs {
                background: #f0f0f0 !important;
                padding: 10px !important;
            }
            .toast {
                position: fixed;
                top: 20px;
                right: 20px;
                background: #000;
                color: #fff;
                padding: 12px 20px;
                border-radius: 10px;
                font-size: 14px;
                transform: translateX(400px);
                transition: transform 0.3s ease-out;
                z-index: 1000;
                max-width: 350px;
            }
            .toast.show {
                transform: translateX(0);
            }
            .toast.error {
                background: #dc2626;
            }
            .fade-in {
                animation: fadeIn 0.3s ease-in;
            }
            @keyframes fadeIn {
                from {
                    opacity: 0;
                }
                to {
                    opacity: 1;
                }
            }
            input[type="file"] {
                display: none;
            }
        </style>
    </head>
    <body>
        <h1>csson demo</h1>
        <textarea
            id="cssoncode"
            placeholder="csson content will be loaded here"
            spellcheck="false"
        ></textarea
        ><br />
        <button id="parsecsson">Parse csson</button>
        <button id="import">Import csson</button>
        <button id="export">Export as json</button>
        <input type="file" id="fileInput" accept=".csson" />
        <h2>Parsed csson:</h2>
        <div style="position: relative">
            <pre><code id="parsedoutput" class="language-json"></code></pre>
            <button
                class="copyBtn"
                data-target="parsedoutput"
                title="Copy"
                style="
                    position: absolute;
                    top: 10px;
                    right: 10px;
                    background: #000;
                    border: none;
                    border-radius: 6px;
                    padding: 6px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                "
            >
                <img
                    class="icon"
                    src="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0 0 24 24'%20width='24'%20height='24'%3E%3Cpath d='M16 2H12C9.17157 2 7.75736 2 6.87868 2.94627C6 3.89254 6 5.41554 6 8.46154V9.53846C6 12.5845 6 14.1075 6.87868 15.0537C7.75736 16 9.17157 16 12 16H16C18.8284 16 20.2426 16 21.1213 15.0537C22 14.1075 22 12.5845 22 9.53846V8.46154C22 5.41554 22 3.89254 21.1213 2.94627C20.2426 2 18.8284 2 16 2Z' stroke-linejoin='round' stroke-linecap='round' stroke-width='1.1' stroke='%23fff' fill='none'/%3E%3Cpath d='M18 16.6082C17.9879 18.9537 17.8914 20.2239 17.123 21.0525C16.2442 22 14.8298 22 12.0011 22H8.00065C5.17192 22 3.75755 22 2.87878 21.0525C2 20.1049 2 18.5799 2 15.5298V14.4515C2 11.4014 2 9.87638 2.87878 8.92885C3.52015 8.2373 4.44682 8.05047 6.00043 8' stroke-linejoin='round' stroke-linecap='round' stroke-width='1.1' stroke='%23fff' fill='none'/%3E%3C/svg%3E"
                    style="width: 20px; height: 20px; transition: opacity 0.3s"
                />
                <img
                    class="check"
                    src="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0 0 24 24'%20width='24'%20height='24'%3E%3Cpath d='m4.5 12.75 6 6 9-13.5' stroke-linejoin='round' stroke-linecap='round' stroke-width='1.1' stroke='%23fff' fill='none'/%3E%3C/svg%3E"
                    style="
                        width: 20px;
                        height: 20px;
                        position: absolute;
                        top: 6px;
                        left: 6px;
                        opacity: 0;
                        pointer-events: none;
                        transition: opacity 0.3s;
                    "
                />
            </button>
        </div>
        <h2>Stringified csson:</h2>
        <div style="position: relative">
            <pre><code id="stringifiedOutput" class="language-json"></code></pre>
            <button
                class="copyBtn"
                data-target="stringifiedOutput"
                title="Copy"
                style="
                    position: absolute;
                    top: 10px;
                    right: 10px;
                    background: #000;
                    border: none;
                    border-radius: 6px;
                    padding: 6px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                "
            >
                <img
                    class="icon"
                    src="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0 0 24 24'%20width='24'%20height='24'%3E%3Cpath d='M16 2H12C9.17157 2 7.75736 2 6.87868 2.94627C6 3.89254 6 5.41554 6 8.46154V9.53846C6 12.5845 6 14.1075 6.87868 15.0537C7.75736 16 9.17157 16 12 16H16C18.8284 16 20.2426 16 21.1213 15.0537C22 14.1075 22 12.5845 22 9.53846V8.46154C22 5.41554 22 3.89254 21.1213 2.94627C20.2426 2 18.8284 2 16 2Z' stroke-linejoin='round' stroke-linecap='round' stroke-width='1.1' stroke='%23fff' fill='none'/%3E%3Cpath d='M18 16.6082C17.9879 18.9537 17.8914 20.2239 17.123 21.0525C16.2442 22 14.8298 22 12.0011 22H8.00065C5.17192 22 3.75755 22 2.87878 21.0525C2 20.1049 2 18.5799 2 15.5298V14.4515C2 11.4014 2 9.87638 2.87878 8.92885C3.52015 8.2373 4.44682 8.05047 6.00043 8' stroke-linejoin='round' stroke-linecap='round' stroke-width='1.1' stroke='%23fff' fill='none'/%3E%3C/svg%3E"
                    style="width: 20px; height: 20px; transition: opacity 0.3s"
                />
                <img
                    class="check"
                    src="data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0 0 24 24'%20width='24'%20height='24'%3E%3Cpath d='m4.5 12.75 6 6 9-13.5' stroke-linejoin='round' stroke-linecap='round' stroke-width='1.1' stroke='%23fff' fill='none'/%3E%3C/svg%3E"
                    style="
                        width: 20px;
                        height: 20px;
                        position: absolute;
                        top: 6px;
                        left: 6px;
                        opacity: 0;
                        pointer-events: none;
                        transition: opacity 0.3s;
                    "
                />
            </button>
        </div>
        <div class="toast" id="toast"></div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script type="module">
            import { csson } from "https://cdn.jsdelivr.net/gh/outbrowsed/csson@main/src/index.min.mjs";
            let parsedObj = null;
            let debounceTimer = null;
            const demo = "example.csson";

            const toast = document.getElementById("toast");
            const showToast = (msg, type = "success") => {
                toast.textContent = msg;
                toast.className = `toast ${type} show`;
                setTimeout(() => toast.classList.remove("show"), 3000);
            };
            const update = () => {
                objOutput.className = "language-json";
                output.className = "language-json";
                objOutput.textContent = JSON.stringify(parsedObj, null, 2);
                output.textContent = csson.stringify(parsedObj);
                delete objOutput.dataset.highlighted;
                delete output.dataset.highlighted;
                hljs.highlightElement(objOutput);
                hljs.highlightElement(output);
                objOutput.parentElement.classList.add("fade-in");
                output.parentElement.classList.add("fade-in");
                setTimeout(() => {
                    objOutput.parentElement.classList.remove("fade-in");
                    output.parentElement.classList.remove("fade-in");
                }, 300);
            };
            const cssonInput = document.getElementById("cssoncode");
            const parsebutton = document.getElementById("parsecsson");

            const parseInput = () => {
                try {
                    parsedObj = csson.parse(cssonInput.value);
                    update();
                } catch (e) {
                    showToast(`Parse error: ${e.message}`, "error");
                }
            };
            const objOutput = document.getElementById("parsedoutput");
            const output = document.getElementById("stringifiedOutput");

            const loadcsson = async (file) => {
                try {
                    const text = await (await fetch(file)).text();
                    cssonInput.value = text;
                    parseInput();
                } catch (e) {
                    objOutput.textContent = `failed to load csson file: ${e.message}`;
                }
            };
            cssonInput.addEventListener("input", () => {
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(parseInput, 500);
            });
            cssonInput.addEventListener("keydown", (e) => {
                if (e.key === "Tab") {
                    e.preventDefault();
                    const start = e.target.selectionStart;
                    const end = e.target.selectionEnd;
                    e.target.value =
                        e.target.value.substring(0, start) + "  " + e.target.value.substring(end);
                    e.target.selectionStart = e.target.selectionEnd = start + 2;
                }
                if (e.key === "Enter") {
                    const start = e.target.selectionStart;
                    const lines = e.target.value.substring(0, start).split("\n");
                    const currentLine = lines[lines.length - 1];
                    const indent = currentLine.match(/^\s*/)[0];
                    setTimeout(() => {
                        const newStart = e.target.selectionStart;
                        e.target.value =
                            e.target.value.substring(0, newStart) +
                            indent +
                            e.target.value.substring(newStart);
                        e.target.selectionStart = e.target.selectionEnd = newStart + indent.length;
                    }, 0);
                }
                if (e.ctrlKey && e.key === "Enter") {
                    e.preventDefault();
                    parseInput();
                }
            });
            document.querySelectorAll(".copyBtn").forEach((btn) => {
                btn.addEventListener("click", () => {
                    const targetId = btn.getAttribute("data-target");
                    const content = document.getElementById(targetId).textContent;
                    const icon = btn.querySelector(".icon");
                    const check = btn.querySelector(".check");
                    navigator.clipboard.writeText(content).then(() => {
                        icon.style.opacity = "0";
                        check.style.opacity = "1";
                        showToast("Copied to clipboard");
                        setTimeout(() => {
                            icon.style.opacity = "1";
                            check.style.opacity = "0";
                        }, 1200);
                    });
                });
            });
            const exportJson = document.getElementById("export");
            const exportjson = () => {
                if (!parsedObj) {
                    showToast("Parse CSSON first", "error");
                    return;
                }
                const blob = new Blob([JSON.stringify(parsedObj, null, 2)], {
                    type: "application/json",
                });
                const a = document.createElement("a");
                a.href = URL.createObjectURL(blob);
                a.download = "export.json";
                a.click();
                showToast("JSON exported successfully");
            };
            const fileInput = document.getElementById("fileInput");
            document.getElementById("import").addEventListener("click", () => fileInput.click());
            fileInput.addEventListener("change", (e) => {
                if (e.target.files[0]) {
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        cssonInput.value = ev.target.result;
                        updateLineNumbers();
                        parseInput();
                        showToast("File imported successfully");
                    };
                    reader.onerror = () => showToast("Failed to read file", "error");
                    reader.readAsText(e.target.files[0]);
                }
            });
            parsebutton.addEventListener("click", parseInput);
            exportJson.addEventListener("click", exportjson);
            loadcsson(demo);
        </script>
    </body>
</html>
